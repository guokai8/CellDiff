% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rankDiffM.R
\name{rankDiffM}
\alias{rankDiffM}
\title{Rank and Visualize Significant Signaling Pathways Across Multiple Groups}
\usage{
rankDiffM(
  object.list,
  comparison = NULL,
  reference = NULL,
  measure = "weight",
  slot.name = "netP",
  color.use = NULL,
  color.pathway = NULL,
  pThresh = 0.05,
  tol = 0.05,
  top.n = NULL,
  show.pval = TRUE,
  show.heatmap = FALSE,
  title = NULL,
  sources.use = NULL,
  targets.use = NULL,
  comparison_method = c("all_vs_ref", "sequential", "custom_pairs"),
  custom_comparisons = NULL,
  show.dendrogram = FALSE,
  show.barplot = TRUE,
  cluster_groups = FALSE,
  use_log2fc = FALSE,
  min_pathways = 3,
  filter_min_change = 0.25,
  order_by = c("foldchange", "pvalue", "pathway_name"),
  show_all_pairwise = FALSE,
  save_plot = FALSE,
  save_name = "rankDiff_plot.pdf",
  save_width = 10,
  save_height = 8,
  return_top_paths = TRUE,
  show_comparison_barplot = TRUE,
  show_comparison_heatmap = FALSE,
  show_comparison_slope = FALSE,
  comparison_plot_type = c("barplot", "heatmap", "slope"),
  heatmap_colors = c("deepskyblue", "white", "darkorange"),
  text_size = 10,
  label_angle = 45,
  border_color = "grey60",
  cell.type.strategy = c("shared", "union"),
  show.all = FALSE
)
}
\arguments{
\item{object.list}{List of CellChat objects}

\item{comparison}{Vector of indices to compare (default NULL, uses all objects)}

\item{reference}{Integer or character, index or name of the reference object to compare against.
If NULL (default), the first object in comparison will be used as reference.}

\item{measure}{Measure type, either "weight" or "count"}

\item{slot.name}{Slot name containing the network information}

\item{color.use}{Vector of colors for the groups}

\item{color.pathway}{Vector of colors for the pathway (slope plot)}

\item{pThresh}{P-value threshold for significant differences}

\item{tol}{Tolerance for fold change significance}

\item{top.n}{Number of top pathways to show}

\item{show.pval}{Whether to show p-values on the plot}

\item{show.heatmap}{Whether to generate a heatmap}

\item{title}{Title for the plot}

\item{sources.use}{Optional vector of source cell types to filter}

\item{targets.use}{Optional vector of target cell types to filter}

\item{comparison_method}{Method for comparing groups: "all_vs_ref" (each group vs reference)
or "sequential" (each group vs next) or "custom_pairs" (specified pairs)}

\item{custom_comparisons}{List of custom comparison pairs}

\item{show.dendrogram}{Whether to show dendrogram in the heatmap}

\item{show.barplot}{Whether to include barplots showing pathway strength}

\item{cluster_groups}{Whether to cluster groups in the heatmap}

\item{use_log2fc}{Whether to use log2 fold change instead of absolute differences}

\item{min_pathways}{Minimum number of pathways to include in visualization}

\item{filter_min_change}{Minimum fold change to consider a pathway significant}

\item{order_by}{Method to order pathways: "foldchange", "pvalue", or "pathway_name"}

\item{show_all_pairwise}{Whether to show all pairwise comparisons in a grid}

\item{save_plot}{Whether to save the plot to file}

\item{save_name}{Filename for saving the plot}

\item{save_width}{Width of the saved plot in inches}

\item{save_height}{Height of the saved plot in inches}

\item{return_top_paths}{Whether to return only top_n pathways or all significant pathways}

\item{show_comparison_barplot}{Show faceted barplot for all comparisons (default: TRUE)}

\item{show_comparison_heatmap}{Show heatmap for all comparisons (default: FALSE)}

\item{show_comparison_slope}{Show slope plot for all comparisons (default: FALSE)}

\item{comparison_plot_type}{Default plot type for comparison: "barplot", "heatmap", or "slope"}

\item{heatmap_colors}{Vector of 3 colors for heatmap gradient (low, mid, high)}

\item{text_size}{Text size for plot elements}

\item{label_angle}{Angle for x-axis labels}

\item{border_color}{Border color for tiles in heatmap}

\item{cell.type.strategy}{Character, strategy for aligning cell types across objects.
"shared" (default) uses only cell types common to all objects (intersection).
"union" uses all cell types from all objects (fills missing with 0).}

\item{show.all}{Logical, whether to show all pathways (TRUE) or only significant pathways
(FALSE, default) in the comparison_barplot and comparison_heatmap. When TRUE,
non-significant pathways are shown with faded colors and significance stars
(*p<0.05, **p<0.01, ***p<0.001) indicate which pathways are significant in each comparison.}
}
\value{
A list containing:
  \item{plots}{List of individual barplots for each comparison}
  \item{heatmaps}{List of individual heatmaps for each comparison (if requested)}
  \item{combined_plot}{Combined plot of all pairwise comparisons (if requested)}
  \item{data}{Data frame with all pathway information and statistics}
  \item{all_significant_paths}{List of significant pathways for each comparison}
  \item{all_significant_paths_full}{List of all significant pathways without top.n limit}
  \item{params}{List of parameters used for the analysis}
  \item{comparison_barplot}{Faceted barplot comparing all conditions to reference (if requested)}
  \item{comparison_heatmap}{Heatmap comparing all conditions to reference (if requested)}
  \item{comparison_slope_plot}{Slope plot showing pathway trends across conditions (if requested)}
  \item{top_paths}{Vector of top pathways based on frequency across comparisons}
}
\description{
This function ranks signaling pathways based on their differential activity
across multiple groups and visualizes the significant ones.
}
\examples{
# Basic usage with default parameters
results <- rankDiffM(
  object.list = cellchat.list,
  comparison_method = "all_vs_ref",
  reference = "WT",
  cell.type.strategy = "shared"
)

# Using log2 fold change and custom visualization options
results <- rankDiffM(
  object.list = cellchat.list,
  comparison_method = "all_vs_ref",
  reference = "WT",
  use_log2fc = TRUE,
  comparison_plot_type = "heatmap",
  heatmap_colors = c("blue", "white", "red"),
  cell.type.strategy = "union"
)

# Using sequential comparison with custom pathway ordering
results <- rankDiffM(
  object.list = cellchat.list,
  comparison_method = "sequential",
  order_by = "pathway_name",
  show_comparison_slope = TRUE,
  cell.type.strategy = "shared"
)

# Show all pathways (not just significant) in comparison plots
results <- rankDiffM(
  object.list = cellchat.list,
  comparison_method = "all_vs_ref",
  reference = "WT",
  show_comparison_barplot = TRUE,
  show.all = TRUE
)

}

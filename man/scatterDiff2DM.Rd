% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scatterDiff2Dm.R
\name{scatterDiff2DM}
\alias{scatterDiff2DM}
\title{2D Scatter Plot of Sender and Receiver Pathway-Level Changes Across Multiple Groups}
\usage{
scatterDiff2DM(
  object.list,
  comparison = NULL,
  reference = NULL,
  pathways = NULL,
  cell.type.strategy = c("shared", "union"),
  thresh = 0.05,
  log.scale = TRUE,
  arrow.size = 1,
  arrow.alpha = 0.8,
  arrow.color = NULL,
  arrow.type = "closed",
  label.cell = TRUE,
  label.size = 3,
  label.color = "black",
  label.repel = TRUE,
  label.box = FALSE,
  label.min.segment.length = 0,
  label.max.overlaps = 10,
  add.quadrants = TRUE,
  quadrant.line.type = "dashed",
  quadrant.line.color = "grey50",
  quadrant.line.alpha = 0.5,
  quadrant.label.size = 3,
  quadrant.label.alpha = 0.7,
  point.size.range = c(2, 6),
  point.alpha.values = c(0.7, 1),
  margin.factor.x = 0.3,
  margin.factor.y = 0.3,
  colors = NULL,
  group.colors = NULL,
  group.shapes = NULL,
  use.group.colors = FALSE,
  show.group.legend = TRUE,
  convex.hull = FALSE,
  hull.alpha = 0.2,
  group.label.size = 3.5,
  show.group.labels = FALSE,
  title = "Changes in Sender-Receiver Roles",
  title.size = 14,
  title.face = "bold",
  axis.text.size = 10,
  axis.title.size = 12,
  legend.position = "right",
  base.theme = ggplot2::theme_bw(),
  plot.type = c("combined", "facet", "grid", "group_colored"),
  facet.ncol = 2,
  highlight.cells = NULL,
  highlight.color = "red",
  comparison_method = c("all_vs_ref", "sequential", "custom_pairs"),
  custom_comparisons = NULL,
  common.scale = TRUE,
  save_plot = FALSE,
  save_name = "scatterDiff2DM.pdf",
  save_width = 10,
  save_height = 8,
  return_data = FALSE
)
}
\arguments{
\item{object.list}{List of CellChat objects}

\item{comparison}{Vector of indices to compare (NULL for all objects)}

\item{reference}{Integer or character, index or name of the reference object to compare against.
If NULL (default), the first object in comparison will be used as reference.}

\item{pathways}{Vector of pathway names to include (NULL for all)}

\item{cell.type.strategy}{Character, strategy for aligning cell types: "shared" (default) or "union"}

\item{thresh}{P-value threshold for significant interactions (default: 0.05)}

\item{log.scale}{Whether to use log scale for axes (default: TRUE)}

\item{arrow.size}{Size of trajectory arrows (default: 1)}

\item{arrow.alpha}{Transparency of trajectory arrows (default: 0.8)}

\item{arrow.color}{Color of arrows (default: NULL, uses cell type colors)}

\item{arrow.type}{Type of arrow head, 'open' or 'closed' (default: "closed")}

\item{label.cell}{Whether to label cell types (default: TRUE)}

\item{label.size}{Size of cell type labels (default: 3)}

\item{label.color}{Color of cell type labels (default: "black")}

\item{label.repel}{Whether to use ggrepel for label placement (default: TRUE)}

\item{label.box}{Whether to add box around labels (default: FALSE)}

\item{label.min.segment.length}{Minimum segment length for repelled labels (default: 0)}

\item{label.max.overlaps}{Maximum allowed label overlaps (default: 10)}

\item{add.quadrants}{Whether to add quadrant lines and labels (default: TRUE)}

\item{quadrant.line.type}{Type of quadrant dividing lines (default: "dashed")}

\item{quadrant.line.color}{Color of quadrant dividing lines (default: "grey50")}

\item{quadrant.line.alpha}{Alpha of quadrant dividing lines (default: 0.5)}

\item{quadrant.label.size}{Size of quadrant labels (default: 3)}

\item{quadrant.label.alpha}{Alpha of quadrant labels (default: 0.7)}

\item{point.size.range}{Range of point sizes (default: c(2, 6))}

\item{point.alpha.values}{Vector of alpha values for conditions (default: c(0.7, 1))}

\item{margin.factor.x}{Horizontal expansion factor for plot margins (default: 0.3)}

\item{margin.factor.y}{Vertical expansion factor for plot margins (default: 0.3)}

\item{colors}{Vector of colors for cell types (default: NULL, uses global_colors)}

\item{group.colors}{Vector of colors for groups/conditions (default: NULL)}

\item{group.shapes}{Vector of shapes for different conditions (default: NULL, auto-generated)}

\item{use.group.colors}{Whether to color points by group instead of cell type (default: FALSE)}

\item{show.group.legend}{Whether to show the group legend (default: TRUE)}

\item{convex.hull}{Whether to draw convex hulls around points of the same group (default: FALSE)}

\item{hull.alpha}{Transparency of convex hulls (default: 0.2)}

\item{group.label.size}{Size of group labels (default: 3.5)}

\item{show.group.labels}{Whether to add labels for each group (default: FALSE)}

\item{title}{Plot title (default: "Changes in Sender-Receiver Roles")}

\item{title.size}{Size of plot title (default: 14)}

\item{title.face}{Font face of plot title (default: "bold")}

\item{axis.text.size}{Size of axis text (default: 10)}

\item{axis.title.size}{Size of axis titles (default: 12)}

\item{legend.position}{Position of the legend (default: "right")}

\item{base.theme}{Base theme for the plot (default: ggplot2::theme_bw())}

\item{plot.type}{Type of plot: "combined" (all trajectories on one plot),
"facet" (separate plot for each condition vs reference),
"grid" (separate plots arranged in a grid), or
"group_colored" (all trajectories on one plot with group coloring)}

\item{facet.ncol}{Number of columns when using faceted plot}

\item{highlight.cells}{Vector of cell types to highlight}

\item{highlight.color}{Color for highlighted cells}

\item{comparison_method}{Method for comparing groups: "all_vs_ref" (each group vs reference)
or "sequential" (each group vs next) or "custom_pairs" (specified pairs)}

\item{custom_comparisons}{List of custom comparison pairs}

\item{common.scale}{Whether to use a common scale for all plots}

\item{save_plot}{Whether to save the plot to file}

\item{save_name}{Filename for saving the plot}

\item{save_width}{Width of the saved plot in inches}

\item{save_height}{Height of the saved plot in inches}

\item{return_data}{Whether to return the data along with the plot}
}
\value{
A ggplot object or a list with plot and data if return_data=TRUE
}
\description{
Creates a 2D scatter plot showing how cell types change in both sender and receiver
dimensions across multiple conditions, using pathway-level information from the netP slot.
}
\examples{
\dontrun{
# Load example data
data(cellchatlist)

# Basic 2D scatter for multiple conditions
plot <- scatterDiff2DM(cellchatlist)

# Use union strategy to include all cell types
plot <- scatterDiff2DM(cellchatlist,
                       cell.type.strategy = "union")

# Faceted plot with union strategy
plot <- scatterDiff2DM(cellchatlist,
                       cell.type.strategy = "union",
                       plot.type = "facet",
                       facet.ncol = 2)

# Group-colored with convex hulls
plot <- scatterDiff2DM(cellchatlist,
                       cell.type.strategy = "union",
                       plot.type = "group_colored",
                       convex.hull = TRUE,
                       use.group.colors = TRUE)
}

}
